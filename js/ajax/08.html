<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Ajax jQuery simple</title>
    <style>
        body {
            background-color: lightgreen;
        }
    </style>
</head>
<body>
    <div id="affichage"></div>

    <script>

      fetch('https://learnwebcode.github.io/json-example/animals-3.json')
        .then(handleResponse)
        .then(data => gereData(data))
        .catch(error => console.log(error))

      function handleResponse (response) {
        let contentType = response.headers.get('content-type')
        if (contentType.includes('application/json')) {
          return handleJSONResponse(response)
        } else if (contentType.includes('text/html')) {
          return handleTextResponse(response)
        } else {
          // Other response types as necessary. I haven't found a need for them yet though.
          throw new Error(`Sorry, content-type ${contentType} not supported`)
        }
      }

      function handleJSONResponse (response) {
        return response.json()
          .then(json => {
            if (response.ok) {
              return json
            } else {
              return Promise.reject(Object.assign({}, json, {
                status: response.status,
                statusText: response.statusText
              }))
            }
          })
      }
      function handleTextResponse (response) {
        return response.text()
          .then(text => {
            if (response.ok) {
              return json
            } else {
              return Promise.reject({
                status: response.status,
                statusText: response.statusText,
                err: text
              })
            }
          })
      }

      function gereData(data) {
          let data2 = data;
          let msg = "";
          for(let i in data2) {
              console.log(`Le  ${data2[i].species  === "cat" ? "chat" : "chien"}  ${data2[i].name} aime ${data2[i].foods.likes}, mais n'aime pas ${data2[i].foods.dislikes}.`);
          }
          document.querySelector("#affichage").innerHTML = msg;
          // console.log(data[i].species);
      }

    </script>
</body>
</html>